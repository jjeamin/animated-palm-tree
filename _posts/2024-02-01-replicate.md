---
layout: post
title:  "Replicate 사용법"
summary: "자신의 인공지능 모델을 Replicate로 배포하기"
date:   2024-02-01 16:00 -0400
categories: review
math: true
---

최근에 개인이나 회사에서 인공지능 모델을 배포하는 작업이 점점 더 중요해지고 있는 추세다.

그러나 인공지능 모델을 배포하기 위해서는 크게 두 가지 문제에 직면하게 된다.

1) GPU를 대여 및 구매하기에는 돈이 없다.

2) 빠르고 효율적이게 배포 개발하고 싶다.

일반적으로 AWS나 다른 클라우드 호스팅 서비스를 이용하여 GPU를 대여하고 시간당 비용을 지불하는 택하는데, 돈이 없는 개인 개발자나 빠르게 시장 검증을 위한 프로덕션을 만드는 팀에게는 이러한 시스템이 부담이 될 수 있다.

이에 대응하기 위해 사람들은 대부분 AWS Lambda와 비슷한 결제 구조를 가진 GPU 클라우드 호스팅 서비스를 원하고 있다. 즉, 사용한 만큼 비용이 발생하는 시스템을 말한다.

그래서 이러한 요구에 맞추어 발빠르게 나온 서비스로 'Replicate' 라는 서비스가 등장했다.

웹사이트: [https://replicate.com/explore](https://replicate.com/explore)

Replicate는 GPU 호스팅을 지원하는 클라우드 플랫폼으로, 다른 사용자가 만든 API를 활용하거나 직접 API를 쉽게 구축하여 사용할 수 있는 플랫폼이다.

사용 시에는 요금이 부과되지만, 이는 로컬 환경에서 충분히 검증한 후에 배포하여 적절하게 활용할 수 있다.

# Replicate 입문

Replicate를 활용하면 다른 사람들이 만든 기능을 접속해볼 수 있는 화면을 확인할 수 있다.



![1](/assets/img/post_img/replicate/1.png)



- Playground: 웹 상에서 직접 코드를 실행하고 결과를 확인할 수 있는 기능이다. 이를 통해 실시간으로 모델의 동작을 시뮬레이션해 볼 수 있다.

- API: Replicate는 사용자에게 API 호출을 위한 코드를 제공한다.

- Examples: Replicate는 API를 만든 사람이 다양한 예제 코드를 공유할 수 있다.

크게 위에 3가지만 알면 직접 **자신의 계정 키** 를 통해 쉽게 사용해볼 수 있다.

한번만 사용해도 돈이 지불되니 주의하자.

# Replicate 금액

Replicate의 금액 시스템도 알아보도록 하자.



![2](/assets/img/post_img/replicate/2.png)



위에는 24.02.01 기준의 금액 테이블이다. 본인이 대략적으로 Replicate 에서 서비스를 몇번 이용해본 결과 Diffusion 기반 모델들은 Nvidia A40 GPU(Large)로 10초 정도 소요되었던 것으로 기억한다.

### Replicate 라이프사이클

아쉽지만 Replicate는 내가 만든 API나 다른 사람이 만든 API가 항상 동작 중인 상태는 아니다.

시스템은 크게 4가지 단계로 구성된다.

1. Offine

아무도 사용하지 않으면 컴퓨터(도커 인스턴스)를 꺼놓는다.

2. Booting

접속이 들어오면 컴퓨터(도커 인스턴스)를 킨다. 이때 많은 시간이 소요되지만 돈은 지불되지 않는다.

3. Active

동작중인 상태다. 이 동작이 끝나기 10초 내로 다른 요청이 들어오는 경우 Active 상태를 유지한다.

4. Idle

Active 상태에서 10초 내로 다른 요청이 없을 시 Offine으로 넘어간다.


여기서 가장 큰 문제는 모든 요청에 대해서 빠르게 서비스를 할 수 없다는 것이다.
